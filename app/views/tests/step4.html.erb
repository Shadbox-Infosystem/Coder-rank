<%= form_with(model: @test, url: step4_tests_path, method: :post, local: true) do |f| %>
  <div class="container mt-5">
    <%= render 'sidebar' %>
    <div class="row justify-content-center">
      <div class="col-md-8">
        <div class="card shadow-sm">
          <div class="card-body">
            <h3 class="text-center mb-4">Add Questions</h3>

            <!-- Question Type -->
            <div class="form-group">
              <%= f.label :question_type, "Question Type", class: "form-label" %>
              <%= f.select :question_type, @question_types, { prompt: "Select Question Type" }, class: "form-control rounded-lg" %>
            </div>

            <!-- Question Content -->
            <div class="form-group">
              <%= f.label :content, "Question Content", class: "form-label" %>
              <%= f.text_area :content, class: "form-control rounded-lg", rows: 3 %>
            </div>

            <!-- Points -->
            <div class="form-group">
              <%= f.label :points, "Points", class: "form-label" %>
              <%= f.number_field :points, class: "form-control rounded-lg", step: 1, min: 0 %>
            </div>

            <!-- Dynamic Answer Fields -->
            <div id="answers-section">
              <h5 class="text-center mt-4">Answers</h5>
              <div class="form-group answer-group mb-3">
                <input type="text" name="question[answers_attributes][][content]" placeholder="Answer Content" class="form-control rounded-lg mb-2">
                <div class="form-check">
                  <input type="checkbox" name="question[answers_attributes][][correct]" class="form-check-input">
                  <label class="form-check-label">Mark as Correct</label>
                </div>
              </div>
            </div>

            <!-- Add Answer Button -->
            <div class="text-center mb-4">
              <button type="button" id="add-answer-btn" class="btn btn-secondary btn-sm">Add Another Answer</button>
            </div>

            <!-- Submit Buttons -->
            <div class="form-group text-center">
              <%= f.submit "Add Another Question", name: "commit", value: "add_another_question", class: "btn btn-secondary btn-lg px-5 rounded-pill" %>
              <div class="form-group text-center">
              <%= f.submit "Next", class: "btn btn-primary btn-lg px-5 rounded-pill" %>
            </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
<% end %>


<style>
  .card {
    border-radius: 1rem;
  }

  .form-label {
    font-weight: bold;
    margin-bottom: 10px;
  }

  .form-control {
    background-color: #f8f9fa;
    border: 1px solid #ccc;
    border-radius: 0.5rem;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
  }

  .form-check-input {
    margin-left: 1rem;
    margin-top: 0.5rem;
  }

  .btn-primary {
    background-color: #007bff;
    border-color: #007bff;
  }

  .btn-primary:hover {
    background-color: #0056b3;
    border-color: #004085;
  }

  .form-group {
    margin-bottom: 20px;
  }

  .container {
    padding: 40px;
  }

  .card-body {
    padding: 30px;
  }

  .btn-lg {
    width: 100%;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const addAnswerBtn = document.getElementById('add-answer-btn');
    const answersSection = document.getElementById('answers-section');

    addAnswerBtn.addEventListener('click', () => {
      const answerGroup = document.createElement('div');
      answerGroup.className = 'form-group answer-group mb-3';

      answerGroup.innerHTML = `
        <input type="text" name="question[answers_attributes][][content]" placeholder="Answer Content" class="form-control rounded-lg mb-2">
        <div class="form-check">
          <input type="checkbox" name="question[answers_attributes][][correct]" class="form-check-input">
          <label class="form-check-label">Mark as Correct</label>
        </div>
      `;

      answersSection.appendChild(answerGroup);
    });
  });
</script>
